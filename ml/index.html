
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://andreavitaletti.github.io/IoT_short_course/ml/">
      
      
        <link rel="prev" href="../web3/">
      
      
        <link rel="next" href="../backend/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>ML on node - A Short Course on IoT</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="lime" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ml-playground" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="A Short Course on IoT" class="md-header__button md-logo" aria-label="A Short Course on IoT" data-md-component="logo">
      
  <img src="../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            A Short Course on IoT
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ML on node
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="A Short Course on IoT" class="md-nav__button md-logo" aria-label="A Short Course on IoT" data-md-component="logo">
      
  <img src="../assets/images/logo.png" alt="logo">

    </a>
    A Short Course on IoT
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../premise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Premise
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Intro
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../simulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simulate a node
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../real/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A real node
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sample/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sampling the Environment
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../wireless/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Wireless Connectivity
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../twin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Digital Twin
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../os/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    An OS is better
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Energy matters
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../web3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IoT and Web3
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    ML on node
  

    
  </span>
  
  

      </a>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../backend/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backend
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../edge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Edge computing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../filters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Filters
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../crowdsourcing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Crowdsourcing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../scale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IoT-lab
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="ml-playground">ML Playground</h1>
<p><a href="https://playground.scienxlab.org/">https://playground.scienxlab.org/</a>
<a href="https://mlplaygrounds.com/machine/learning/linearRegression.html">https://mlplaygrounds.com/machine/learning/linearRegression.html</a></p>
<h1 id="tensorflow-lite-micro-on-esp32">Tensorflow Lite Micro on ESP32</h1>
<p>Reference examples are available <a href="https://github.com/espressif/tflite-micro-esp-examples">here</a>. You have to download from github <a href="https://github.com/espressif/esp-nn">esp-nn</a> and <a href="https://github.com/espressif/esp32-camera">esp32-camera</a> and place them into the relative folders under components.</p>
<p>Then go to examples/hello_worlds and as usual idf.py build, idf.py flash and finally idf.py monitor.</p>
<p>A nice explanation on how the model is generated can be found on the book <a href="https://www.oreilly.com/library/view/tinyml/9781492052036/ch04.html">TinyML by Pete Warden, Daniel Situnayake</a>. The corresponding jupyter notebook is available <a href="https://colab.research.google.com/github/goodboychan/goodboychan.github.io/blob/main/_notebooks/2020-09-24-01-Training-Hello-world-Model-for-Microcontroller.ipynb">here</a></p>
<p>Some other useful resources are listed below:</p>
<ul>
<li><a href="https://medium.com/@dmytro.korablyov/first-steps-with-esp32-and-tensorflow-lite-for-microcontrollers-c2d8e238accf">First steps with ESP32 and TensorFlow Lite for Microcontrollers</a></li>
<li><a href="https://www.tensorflow.org/lite/microcontrollers/get_started_low_level">Get started with microcontrollers</a></li>
</ul>
<h2 id="anomaly-detection">Anomaly detection</h2>
<p>Build a <strong>real-time anomaly detector</strong> that identifies unusual patterns in sensor data (e.g., temperature, vibration, or audio) directly on the ESP32 using TinyML.</p>
<hr />
<h2 id="step-1-choose-a-dataset-sensor">Step 1: Choose a dataset / sensor</h2>
<p>Some options suitable for ESP32 sensors:</p>
<table>
<thead>
<tr>
<th>Sensor type</th>
<th>Example dataset / task</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Accelerometer</td>
<td>Detect unusual movement of a device (falling, shaking)</td>
<td>Use onboard MPU6050</td>
</tr>
<tr>
<td>Temperature</td>
<td>Detect abnormal temperature spikes</td>
<td>Simple, easy for TinyML</td>
</tr>
<tr>
<td>Microphone</td>
<td>Detect unusual sounds (e.g., clapping, alarm)</td>
<td>Use I2S mic, feasible with Edge Impulse</td>
</tr>
<tr>
<td>Vibration</td>
<td>Predict machine anomalies</td>
<td>Requires IMU or piezo sensor</td>
</tr>
<tr>
<td>## Step 2: Define the anomaly detection approach</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>There are several approaches suitable for TinyML:</p>
<ol>
<li><strong>Statistical thresholding</strong><ul>
<li>Keep a running mean &amp; standard deviation of sensor readings.</li>
<li>Flag readings that are &gt;2–3σ from the mean.</li>
<li>Pros: very light, easy on ESP32 RAM.</li>
<li>Cons: sensitive to noise.</li>
</ul>
</li>
<li><strong>One-class ML model</strong><ul>
<li>Train a model only on “normal” data, flag anything deviating.</li>
<li>TinyML-compatible options:<ul>
<li><strong>TensorFlow Lite for Microcontrollers (TFLM)</strong> with a small fully connected NN</li>
<li><strong>Isolation Forest</strong> (can be converted to tiny NN)</li>
<li><strong>Autoencoder</strong>: small network compressing and reconstructing input, high reconstruction error → anomaly</li>
</ul>
</li>
</ul>
</li>
<li><strong>TinyML library examples</strong><ul>
<li><strong>Edge Impulse Anomaly Detection</strong>: supports accelerometer, microphone, temp sensors. Generates ready-to-deploy TFLite micro models for ESP32.</li>
</ul>
</li>
</ol>
<h2 id="step-3-preprocessing-feature-extraction">Step 3: Preprocessing &amp; feature extraction</h2>
<p>Depending on the sensor:</p>
<table>
<thead>
<tr>
<th>Sensor</th>
<th>Features</th>
</tr>
</thead>
<tbody>
<tr>
<td>Accelerometer</td>
<td>RMS, mean, variance, FFT energy</td>
</tr>
<tr>
<td>Temperature</td>
<td>Rolling mean, slope, variance</td>
</tr>
<tr>
<td>Microphone</td>
<td>MFCCs, energy, zero-crossing rate</td>
</tr>
<tr>
<td>Vibration</td>
<td>RMS, spectral centroid, peak-to-peak</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Keep the features small (&lt;10–20 floats) to fit TinyML models on ESP32.</p>
</blockquote>
<h2 id="step-4-train-the-model">Step 4: Train the model</h2>
<ol>
<li>Collect “normal” data with ESP32 or simulate in Python.</li>
<li>Train a tiny autoencoder or fully connected NN (e.g., 2–3 hidden layers, 16–32 neurons each).</li>
<li>Convert to <strong>TensorFlow Lite for Microcontrollers</strong>.</li>
<li>Load onto ESP32 using Arduino, PlatformIO, or ESP-IDF.</li>
</ol>
<hr />
<h2 id="step-5-run-inference-on-esp32">Step 5: Run inference on ESP32</h2>
<ul>
<li>Sample the sensor every X ms (e.g., 100 ms).</li>
<li>Feed the features to the TinyML model.</li>
<li>Compute anomaly score:<ul>
<li>Autoencoder: <code>score = ||input - reconstructed||</code></li>
<li>Threshold: if score &gt; threshold → anomaly</li>
</ul>
</li>
<li>Optional: trigger an LED, buzzer, or send a message via Wi-Fi/LoRa.</li>
</ul>
<hr />
<h2 id="exercise">Exercise</h2>
<ol>
<li>Collect <strong>1 minute of normal temperature data</strong> from ESP32 sensor.</li>
<li>Train a <strong>TinyML autoencoder</strong> on this data.</li>
<li>Introduce a <strong>synthetic anomaly</strong> (e.g., sudden spike).</li>
<li>Deploy model on ESP32.</li>
<li>Detect anomaly <strong>in real time</strong> and light up LED.</li>
<li>Optional challenge: add <strong>wireless logging</strong> of anomalies to a server.</li>
</ol>
<h2 id="python-tensorflow-training-the-autoencoder">Python / TensorFlow – Training the Autoencoder</h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># 1.0 Create dummy data (Normal = 20-30 degrees)</span>
<span class="c1">#data = np.random.uniform(20, 30, (1000, 1)).astype(&#39;float32&#39;)</span>

<span class="c1"># 1.1 Mean of 25 degrees, standard deviation of 2</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="c1"># Clip it to ensure it stays within reasonable physical bounds</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">normal_data</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>

<span class="c1"># 2. Define the Autoencoder</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
<span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,)),</span>
<span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span> <span class="c1"># Encoder</span>
<span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span> <span class="c1"># Decoder</span>
<span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1">#######################################################################</span>

<span class="c1"># 3. Convert to TFLit</span>
<span class="n">converter</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">lite</span><span class="o">.</span><span class="n">TFLiteConverter</span><span class="o">.</span><span class="n">from_keras_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">tflite_model</span> <span class="o">=</span> <span class="n">converter</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>

<span class="c1"># 4. Save as a C header file</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;model_data.h&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;const unsigned char autoencoder_model_data[] = {</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Convert binary to hex strings</span>
    <span class="n">hex_data</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;0x</span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="s2">02x</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">tflite_model</span><span class="p">]</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">hex_data</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">};</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;const unsigned int autoencoder_model_data_len = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tflite_model</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</code></pre></div>
<p>This trains a tiny autoencoder on "normal" temperature values. A convenient way to make a test is to use Colab</p>
<div class="highlight"><pre><span></span><code><span class="n">test_anomaly</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">50.0</span><span class="p">]])</span> <span class="c1"># Way too hot!</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_anomaly</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input: 50.0, Reconstruction: </span><span class="si">{</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, Error: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="mf">50.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Adding <strong>Normalization</strong> is the "secret sauce" for neural networks.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>

<span class="c1"># Define expected range</span>
<span class="n">MIN_TEMP</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">MAX_TEMP</span> <span class="o">=</span> <span class="mf">40.0</span>

<span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">MIN_TEMP</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">MAX_TEMP</span> <span class="o">-</span> <span class="n">MIN_TEMP</span><span class="p">)</span>

<span class="c1"># Generate normal training data (20 to 30 degrees)</span>
<span class="n">raw_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="n">normalized_data</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

<span class="c1"># Simple Autoencoder</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,)),</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span> 
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">)</span> <span class="c1"># Sigmoid forces output 0-1</span>
<span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">,</span> <span class="n">normalized_data</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Export... (use the same conversion script as before)</span>
</code></pre></div>
<h2 id="arduino-esp32-load-run-tflite-model">Arduino / ESP32 – Load &amp; Run TFLite Model</h2>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Arduino.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;model_data.h&quot;</span><span class="c1"> // Must contain autoencoder_model_data and autoencoder_model_data_len</span>

<span class="c1">// TensorFlow Lite Micro Headers</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;tensorflow/lite/micro/all_ops_resolver.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;tensorflow/lite/micro/micro_interpreter.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;tensorflow/lite/micro/micro_error_reporter.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;tensorflow/lite/schema/schema_generated.h&quot;</span>

<span class="c1">// --- Configuration ---</span>
<span class="cp">#define SENSOR_PIN 34</span>
<span class="cp">#define LED_PIN 2</span>

<span class="c1">// Normalization constants (Must match your Python script!)</span>
<span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">MIN_TEMP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10.0</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">MAX_TEMP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">40.0</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">ANOMALY_THRESHOLD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.15</span><span class="p">;</span><span class="w"> </span><span class="c1">// 15% reconstruction error</span>

<span class="c1">// --- TFLM Globals ---</span>
<span class="c1">// Alignment is crucial for ESP32/ARM performance</span>
<span class="k">alignas</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">tensor_arena</span><span class="p">[</span><span class="mi">15</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">];</span><span class="w"> </span>

<span class="n">tflite</span><span class="o">::</span><span class="n">MicroInterpreter</span><span class="o">*</span><span class="w"> </span><span class="n">interpreter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nullptr</span><span class="p">;</span>
<span class="n">TfLiteTensor</span><span class="o">*</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nullptr</span><span class="p">;</span>
<span class="n">TfLiteTensor</span><span class="o">*</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nullptr</span><span class="p">;</span>
<span class="k">static</span><span class="w"> </span><span class="n">tflite</span><span class="o">::</span><span class="n">MicroErrorReporter</span><span class="w"> </span><span class="n">error_reporter</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="w">    </span><span class="n">pinMode</span><span class="p">(</span><span class="n">LED_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">OUTPUT</span><span class="p">);</span>
<span class="w">    </span><span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>

<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Initializing Anomaly Detector...&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 1. Load the Model</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">tflite</span><span class="o">::</span><span class="n">Model</span><span class="o">*</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tflite</span><span class="o">::</span><span class="n">GetModel</span><span class="p">(</span><span class="n">autoencoder_model_data</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">model</span><span class="o">-&gt;</span><span class="n">version</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">TFLITE_SCHEMA_VERSION</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Model schema mismatch!&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 2. Resolver (Registers the layers like Dense, Relu)</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">tflite</span><span class="o">::</span><span class="n">AllOpsResolver</span><span class="w"> </span><span class="n">resolver</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 3. Create Interpreter</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">tflite</span><span class="o">::</span><span class="n">MicroInterpreter</span><span class="w"> </span><span class="n">static_interpreter</span><span class="p">(</span>
<span class="w">        </span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">resolver</span><span class="p">,</span><span class="w"> </span><span class="n">tensor_arena</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">tensor_arena</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">error_reporter</span><span class="p">);</span>

<span class="w">    </span><span class="n">interpreter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">static_interpreter</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 4. Allocate memory for tensors</span>
<span class="w">    </span><span class="n">TfLiteStatus</span><span class="w"> </span><span class="n">allocate_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">interpreter</span><span class="o">-&gt;</span><span class="n">AllocateTensors</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">allocate_status</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">kTfLiteOk</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;AllocateTensors() failed! Increase arena size.&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 5. Get pointers to input/output buffers</span>
<span class="w">    </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">interpreter</span><span class="o">-&gt;</span><span class="n">input</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">interpreter</span><span class="o">-&gt;</span><span class="n">output</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;System Ready. Monitoring Sensor...&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">loop</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// --- 1. Data Acquisition &amp; Scaling ---</span>
<span class="w">    </span><span class="c1">// Read 12-bit analog (0-4095) and convert to Celsius (example math)</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">raw_voltage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">analogRead</span><span class="p">(</span><span class="n">SENSOR_PIN</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.3</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">4095.0</span><span class="p">);</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">raw_temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">raw_voltage</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">10.0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">20.0</span><span class="p">;</span><span class="w"> </span>

<span class="w">    </span><span class="c1">// Normalize to 0.0 - 1.0 (Same as Python!)</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">normalized_input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">raw_temp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">MIN_TEMP</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">MAX_TEMP</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">MIN_TEMP</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Safety clip to keep input within 0.0 and 1.0</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">normalized_input</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">)</span><span class="w"> </span><span class="n">normalized_input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">normalized_input</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1.0f</span><span class="p">)</span><span class="w"> </span><span class="n">normalized_input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0f</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// --- 2. Inference ---</span>
<span class="w">    </span><span class="n">input</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">.</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">normalized_input</span><span class="p">;</span>

<span class="w">    </span><span class="n">TfLiteStatus</span><span class="w"> </span><span class="n">invoke_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">interpreter</span><span class="o">-&gt;</span><span class="n">Invoke</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">invoke_status</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">kTfLiteOk</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Inference failed!&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">normalized_output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">output</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">.</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

<span class="w">    </span><span class="c1">// --- 3. Anomaly Logic ---</span>
<span class="w">    </span><span class="c1">// Reconstruction error = |Input - Output|</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">anomaly_score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">normalized_input</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">normalized_output</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Convert reconstruction back to Celsius for display</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">recon_temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">normalized_output</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">MAX_TEMP</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">MIN_TEMP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">MIN_TEMP</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// --- 4. Reporting ---</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Real: &quot;</span><span class="p">);</span><span class="w"> </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">raw_temp</span><span class="p">);</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot; | Recon: &quot;</span><span class="p">);</span><span class="w"> </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">recon_temp</span><span class="p">);</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot; | Score: &quot;</span><span class="p">);</span><span class="w"> </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">anomaly_score</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">anomaly_score</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">ANOMALY_THRESHOLD</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;&gt;&gt;&gt; ANOMALY DETECTED! &lt;&lt;&lt;&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">LED_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">HIGH</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">LED_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">LOW</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span><span class="w"> </span><span class="c1">// 2Hz sampling</span>
<span class="p">}</span>
</code></pre></div>
<ol>
<li>In the context of an <strong>Autoencoder</strong>, an anomaly is detected when the model <strong>fails to recreate the input accurately</strong>. Anomaly Score == ∣∣x−x^∣∣ (see below)</li>
<li>Very lightweight: <strong>fits ESP32 with ~2 KB tensor arena</strong>.</li>
</ol>
<h2 id="why-autoencoder">Why Autoencoder?</h2>
<p>We want to <strong>detect anomalies</strong> in sensor data, e.g., temperature spikes, unusual vibration, or abnormal movement patterns.</p>
<p>Key points:</p>
<ul>
<li><strong>Normal data is abundant</strong></li>
<li><strong>Anomalies are rare</strong> or hard to label in advance</li>
</ul>
<p>This is a classic <strong>unsupervised anomaly detection problem</strong>.</p>
<p>An <strong>autoencoder</strong> is a neural network trained to <strong>reconstruct its input</strong>:</p>
<p><code>Input x  →  Encoder → Latent Space → Decoder → Output x̂ (reconstruction)</code></p>
<ul>
<li>It <strong>learns the patterns of “normal” data</strong>.</li>
<li>If you feed it a <strong>normal sample</strong>, it reconstructs it accurately → low reconstruction error.</li>
<li>If you feed it an <strong>anomalous sample</strong>, it cannot reconstruct it well → high reconstruction error.</li>
</ul>
<p>So the <strong>reconstruction error</strong> can be used as an <strong>anomaly score</strong>:</p>
<p>Anomaly Score == ∣∣x−x^∣∣</p>
<table>
<thead>
<tr>
<th>Advantage</th>
<th>Why it matters for ESP32</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Lightweight</strong></td>
<td>A small autoencoder (few layers, few neurons) can run on a microcontroller.</td>
</tr>
<tr>
<td><strong>No labeled anomalies needed</strong></td>
<td>Only needs normal data to train. Useful because anomalies are rare.</td>
</tr>
<tr>
<td><strong>Generalizable</strong></td>
<td>Can detect anomalies that were not seen during training.</td>
</tr>
<tr>
<td><strong>Simple inference</strong></td>
<td>Forward pass only → low latency → real-time detection.</td>
</tr>
<tr>
<td>## Alternative approaches vs autoencoder</td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Method</th>
<th>Pros</th>
<th>Cons for ESP32</th>
</tr>
</thead>
<tbody>
<tr>
<td>Statistical threshold (mean ± 3σ)</td>
<td>Very light</td>
<td>Doesn’t capture complex patterns; sensitive to noise</td>
</tr>
<tr>
<td>One-class SVM</td>
<td>Can capture nonlinear boundaries</td>
<td>Memory-heavy; slower inference</td>
</tr>
<tr>
<td>Isolation Forest</td>
<td>Good for multidimensional data</td>
<td>Not trivial to run on microcontrollers</td>
</tr>
<tr>
<td>Autoencoder</td>
<td>Captures complex patterns, light</td>
<td>Needs tiny neural network tuning</td>
</tr>
</tbody>
</table>
<p>✅ Autoencoder is a <strong>perfect balance</strong> between capability and feasibility for TinyML on microcontrollers.</p>
<h2 id="intuition">Intuition</h2>
<p>Think of it like this:</p>
<ul>
<li>Autoencoder learns a <strong>“normal sensor behavior fingerprint.”</strong></li>
<li>Anything that deviates from that fingerprint → flagged as anomaly.    </li>
<li>Works for <strong>time series</strong>, <strong>multivariate data</strong>, or even <strong>audio features (MFCCs)</strong>.</li>
</ul>
<div class="highlight"><pre><span></span><code>         Normal Data                 Anomalous Data
       ----------------          ----------------
       Temp = 25 ± 0.5             Temp spike = 30
           |                            |
           v                            v
      +-------------+             +-------------+
      |   Encoder   |             |   Encoder   |
      +-------------+             +-------------+
           |                            |
           v                            v
     Latent representation         Latent representation
           |                            |
           v                            v
      +-------------+             +-------------+
      |   Decoder   |             |   Decoder   |
      +-------------+             +-------------+
           |                            |
           v                            v
      Reconstructed Temp = 25 ± 0.5   Reconstructed Temp ≈ 25.1
           |                            |
           v                            v
   Reconstruction error ≈ 0        Reconstruction error ≈ 4.9
           |                            |
           v                            v
   ✅ Normal                       ⚠️ Anomaly detected
</code></pre></div>
<ul>
<li><strong>Normal Data</strong><ul>
<li>Autoencoder is trained on “normal” temperature readings (~25°C).</li>
<li>Encoder compresses input → decoder reconstructs it almost perfectly.</li>
<li><strong>Reconstruction error ≈ 0 → Not an anomaly.</strong></li>
</ul>
</li>
<li>
<p><strong>Anomalous Data</strong></p>
<ul>
<li>Temperature suddenly spikes to 30°C.</li>
<li>Autoencoder has <strong>never seen this pattern</strong>, so reconstruction fails.</li>
<li><strong>Reconstruction error is high → anomaly detected.</strong></li>
</ul>
</li>
<li>
<p>Works <strong>without labeled anomalies</strong>    </p>
</li>
<li><strong>Lightweight computation</strong>: forward pass only</li>
<li>Can extend to <strong>multivariate input</strong> (temperature + humidity + vibration)</li>
<li>Threshold on reconstruction error decides <strong>anomaly vs normal</strong></li>
</ul>
<p><img alt="reconstruction_error.png" src="../assets/images/reconstruction_error.png" /></p>
<p><img alt="signal_vs_reconstruction-2026212474173.png" src="../assets/images/signal_vs_reconstruction-2026212474173.png" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Created by Andrea Vitaletti.<br/><img alt="" style="border-width:0" src="https://andreavitaletti.github.io/IoT_short_course/assets/images/mail.png" /></br><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://discord.gg/TZhMmbgq" target="_blank" rel="noopener" title="discord.gg" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/andrea-vitaletti-3651442/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>